# LSTM ë”¥ëŸ¬ë‹ íŒŒì´í”„ë¼ì¸ ê°€ì´ë“œ

## ë¹ ë¥¸ ì‹œì‘

### 1. ê¸°ë³¸ ì‹¤í–‰
```bash
python scripts/DL/train_lstm.py
```

### 2. ë¹ ë¥¸ í…ŒìŠ¤íŠ¸ (ì‘ì€ ì„¤ì •)
```bash
python scripts/DL/example_usage.py --example 5
```

## ğŸ“‹ ëª©ì°¨
1. [ê°œìš”](#ê°œìš”)
2. [ë””ë ‰í† ë¦¬ êµ¬ì¡°](#ë””ë ‰í† ë¦¬-êµ¬ì¡°)
3. [ì²˜ë¦¬ ìˆœì„œ](#ì²˜ë¦¬-ìˆœì„œ)
4. [ëª¨ë“ˆ ì„¤ëª…](#ëª¨ë“ˆ-ì„¤ëª…)
5. [ì‚¬ìš© ë°©ë²•](#ì‚¬ìš©-ë°©ë²•)
6. [ì„¤ì • ê°€ì´ë“œ](#ì„¤ì •-ê°€ì´ë“œ)
7. [ë¬¸ì œ í•´ê²°](#ë¬¸ì œ-í•´ê²°)

## ê°œìš”

ì´ íŒŒì´í”„ë¼ì¸ì€ í•˜ìˆ˜ì²˜ë¦¬ì¥ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ LSTM ê¸°ë°˜ ì‹œê³„ì—´ ì˜ˆì¸¡ ëª¨ë¸ì„ í•™ìŠµí•©ë‹ˆë‹¤.

### ì£¼ìš” íŠ¹ì§•
- âœ… ì™„ì „ ìë™í™”ëœ ì „ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸
- âœ… ê²°ì¸¡ì¹˜ ë° ì´ìƒì¹˜ ì²˜ë¦¬ (ë„ë©”ì¸ ì§€ì‹ + í†µê³„)
- âœ… ìë™ íŠ¹ì„± ìƒì„± (ì‹œê°„, Lag, Rolling)
- âœ… ìŠ¬ë¼ì´ë”© ìœˆë„ìš° ê¸°ë°˜ ì‹œê³„ì—´ í•™ìŠµ
- âœ… ì¡°ê¸° ì¢…ë£Œ ë° ê·¸ë˜ë””ì–¸íŠ¸ í´ë¦¬í•‘
- âœ… ìë™ í‰ê°€ ë° ì‹œê°í™”

## ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
project_WWTP/
â”œâ”€â”€ data/
â”‚   â””â”€â”€ actual/                    # ì›ë³¸ ë°ì´í„°
â”‚       â”œâ”€â”€ FLOW_Actual.csv
â”‚       â”œâ”€â”€ TMS_Actual.csv
â”‚       â”œâ”€â”€ AWS_368.csv
â”‚       â”œâ”€â”€ AWS_541.csv
â”‚       â””â”€â”€ AWS_569.csv
â”‚
â”œâ”€â”€ src/
â”‚   â””â”€â”€ DL/                        # ë”¥ëŸ¬ë‹ ëª¨ë“ˆ
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ config.py              # ì„¤ì • ê´€ë¦¬
â”‚       â”œâ”€â”€ data_loader.py         # ë°ì´í„° ë¡œë“œ
â”‚       â”œâ”€â”€ preprocessing.py       # ì „ì²˜ë¦¬ (ê²°ì¸¡ì¹˜, ì´ìƒì¹˜)
â”‚       â”œâ”€â”€ features.py            # íŠ¹ì„± ìƒì„±
â”‚       â”œâ”€â”€ sliding_window.py      # ìŠ¬ë¼ì´ë”© ìœˆë„ìš°
â”‚       â”œâ”€â”€ model.py               # LSTM ëª¨ë¸ ì •ì˜
â”‚       â”œâ”€â”€ trainer.py             # ëª¨ë¸ í•™ìŠµ
â”‚       â”œâ”€â”€ evaluator.py           # ëª¨ë¸ í‰ê°€
â”‚       â””â”€â”€ pipeline.py            # ì „ì²´ íŒŒì´í”„ë¼ì¸
â”‚
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ DL/                        # ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ train_lstm.py          # ë©”ì¸ í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸
â”‚       â”œâ”€â”€ example_usage.py       # ì‚¬ìš© ì˜ˆì œ
â”‚       â””â”€â”€ README.md
â”‚
â”œâ”€â”€ model/                         # í•™ìŠµëœ ëª¨ë¸ ì €ì¥
â”‚
â”œâ”€â”€ results/
â”‚   â””â”€â”€ DL/                        # ê²°ê³¼ ì €ì¥
â”‚       â”œâ”€â”€ metrics.json
â”‚       â”œâ”€â”€ predictions_*.csv
â”‚       â”œâ”€â”€ training_history.png
â”‚       â”œâ”€â”€ predictions_test.png
â”‚       â”œâ”€â”€ model.pth
â”‚       â”œâ”€â”€ X_scaler.pkl
â”‚       â””â”€â”€ y_scaler.pkl
â”‚
â”œâ”€â”€ QUICK_START_DL.md              # ë¹ ë¥¸ ì‹œì‘ ê°€ì´ë“œ
â””â”€â”€ DL_PIPELINE_GUIDE.md           # ì´ ë¬¸ì„œ
```

## ì²˜ë¦¬ ìˆœì„œ

### ì „ì²´ íŒŒì´í”„ë¼ì¸ íë¦„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. ë°ì´í„° ë¡œë“œ                                               â”‚
â”‚    - CSV íŒŒì¼ ë¡œë“œ                                           â”‚
â”‚    - ì‹œê°„ ì»¬ëŸ¼ íŒŒì‹±                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. ì‹œê°„ì¶• ì •í•© (1ë¶„ ê°„ê²©)                                    â”‚
â”‚    - ê³µí†µ ì‹œê°„ ì¸ë±ìŠ¤ ìƒì„±                                   â”‚
â”‚    - ë°ì´í„°í”„ë ˆì„ ë³‘í•©                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. ê²°ì¸¡ì¹˜ ì²˜ë¦¬                                               â”‚
â”‚    - ë‹¨ê¸° (1-3ì‹œê°„): Forward Fill                            â”‚
â”‚    - ì¤‘ê¸° (4-12ì‹œê°„): EWMA                                   â”‚
â”‚    - ì¥ê¸° (12ì‹œê°„+): NaN ìœ ì§€                                â”‚
â”‚    - ê²°ì¸¡ì¹˜ ë§ˆìŠ¤í¬ ìƒì„±                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. ì´ìƒì¹˜ ì²˜ë¦¬                                               â”‚
â”‚    - ë„ë©”ì¸ ì§€ì‹ ê¸°ë°˜ íƒì§€                                   â”‚
â”‚    - í†µê³„ì  ë°©ë²• (IQR/Z-score)                               â”‚
â”‚    - ë‘˜ ë‹¤ ì´ìƒì¹˜ì¸ ê²½ìš°ë§Œ ì²˜ë¦¬ (ë³´ìˆ˜ì )                     â”‚
â”‚    - ì´ìƒì¹˜ ë§ˆìŠ¤í¬ ìƒì„±                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. ë¦¬ìƒ˜í”Œë§ (1ì‹œê°„ ê°„ê²©)                                     â”‚
â”‚    - ì‹œê°„ ê°„ê²© ì¡°ì •                                          â”‚
â”‚    - ì§‘ê³„ í•¨ìˆ˜ ì ìš© (mean/sum/max ë“±)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. íŠ¹ì„± ìƒì„±                                                 â”‚
â”‚    - ì‹œê°„ íŠ¹ì„±: hour, dayofweek, month, season              â”‚
â”‚    - ì£¼ê¸°ì„± íŠ¹ì„±: sin/cos ë³€í™˜                               â”‚
â”‚    - Lag íŠ¹ì„±: 1, 2, 3, 6, 12, 24ì‹œê°„                        â”‚
â”‚    - Rolling íŠ¹ì„±: mean, std (3, 6, 12, 24ì‹œê°„)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. ìŠ¬ë¼ì´ë”© ìœˆë„ìš° ìƒì„±                                      â”‚
â”‚    - ê³¼ê±° 24ì‹œê°„ ë°ì´í„° â†’ ë‹¤ìŒ 1ì‹œê°„ ì˜ˆì¸¡                    â”‚
â”‚    - 3D í…ì„œ ìƒì„±: (samples, window_size, features)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 8. ë°ì´í„° ìŠ¤ì¼€ì¼ë§                                           â”‚
â”‚    - Train/Valid/Test ë¶„í•  (70%/15%/15%)                    â”‚
â”‚    - StandardScaler ì ìš©                                     â”‚
â”‚    - X, y ê°ê° ìŠ¤ì¼€ì¼ë§                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 9. ëª¨ë¸ í•™ìŠµ                                                 â”‚
â”‚    - LSTM ëª¨ë¸ ìƒì„±                                          â”‚
â”‚    - Adam ì˜µí‹°ë§ˆì´ì €                                         â”‚
â”‚    - MSE ì†ì‹¤ í•¨ìˆ˜                                           â”‚
â”‚    - ì¡°ê¸° ì¢…ë£Œ (patience=10)                                 â”‚
â”‚    - ê·¸ë˜ë””ì–¸íŠ¸ í´ë¦¬í•‘                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 10. ëª¨ë¸ í‰ê°€                                                â”‚
â”‚     - Train/Valid/Test ì„¸íŠ¸ ì˜ˆì¸¡                             â”‚
â”‚     - í‰ê°€ ì§€í‘œ ê³„ì‚°: MSE, RMSE, MAE, R2, MAPE              â”‚
â”‚     - ì—­ìŠ¤ì¼€ì¼ë§                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 11. ê²°ê³¼ ì €ì¥                                                â”‚
â”‚     - í‰ê°€ ì§€í‘œ (JSON)                                       â”‚
â”‚     - ì˜ˆì¸¡ê°’ (CSV)                                           â”‚
â”‚     - í•™ìŠµ íˆìŠ¤í† ë¦¬ í”Œë¡¯ (PNG)                               â”‚
â”‚     - ì˜ˆì¸¡ í”Œë¡¯ (PNG)                                        â”‚
â”‚     - ëª¨ë¸ ê°€ì¤‘ì¹˜ (PTH)                                      â”‚
â”‚     - ìŠ¤ì¼€ì¼ëŸ¬ (PKL)                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ëª¨ë“ˆ ì„¤ëª…

### 1. config.py - ì„¤ì • ê´€ë¦¬
```python
# ëª¨ë“  ì„¤ì •ì„ dataclassë¡œ ê´€ë¦¬
- DataConfig: ë°ì´í„° ì²˜ë¦¬ ì„¤ì •
- FeatureConfig: íŠ¹ì„± ìƒì„± ì„¤ì •
- WindowConfig: ìŠ¬ë¼ì´ë”© ìœˆë„ìš° ì„¤ì •
- SplitConfig: ë°ì´í„° ë¶„í•  ì„¤ì •
- LSTMConfig: LSTM ëª¨ë¸ ì„¤ì •
- TrainingConfig: í•™ìŠµ ì„¤ì •
- PipelineConfig: ì „ì²´ íŒŒì´í”„ë¼ì¸ ì„¤ì •
```

### 2. data_loader.py - ë°ì´í„° ë¡œë“œ
```python
# ì£¼ìš” í•¨ìˆ˜
- load_raw_data(): CSV íŒŒì¼ ë¡œë“œ
- set_datetime_index(): ì‹œê°„ ì¸ë±ìŠ¤ ì„¤ì •
- align_time_index(): ì‹œê°„ì¶• ì •í•©
- merge_dataframes(): ë°ì´í„°í”„ë ˆì„ ë³‘í•©
```

### 3. preprocessing.py - ì „ì²˜ë¦¬
```python
# ê²°ì¸¡ì¹˜ ì²˜ë¦¬
- impute_missing(): ë‹¨ê¸°/ì¤‘ê¸°/ì¥ê¸° ì „ëµ
- ImputationConfig: ê²°ì¸¡ì¹˜ ì²˜ë¦¬ ì„¤ì •

# ì´ìƒì¹˜ ì²˜ë¦¬
- detect_outliers_domain(): ë„ë©”ì¸ ì§€ì‹ ê¸°ë°˜
- detect_outliers_statistical(): í†µê³„ì  ë°©ë²•
- handle_outliers(): ì´ìƒì¹˜ íƒì§€ ë° ì²˜ë¦¬
- OutlierConfig: ì´ìƒì¹˜ ì²˜ë¦¬ ì„¤ì •

# ë¦¬ìƒ˜í”Œë§
- resample_data(): ì‹œê°„ ê°„ê²© ì¡°ì •
```

### 4. features.py - íŠ¹ì„± ìƒì„±
```python
# ì£¼ìš” í•¨ìˆ˜
- add_time_features(): ì‹œê°„ íŠ¹ì„± (hour, dayofweek, month, season)
- add_lag_features(): Lag íŠ¹ì„± (1, 2, 3, 6, 12, 24ì‹œê°„)
- add_rolling_features(): Rolling í†µê³„ (mean, std, min, max)
- create_features(): ì „ì²´ íŠ¹ì„± ìƒì„± íŒŒì´í”„ë¼ì¸
```

### 5. sliding_window.py - ìŠ¬ë¼ì´ë”© ìœˆë„ìš°
```python
# ì£¼ìš” í•¨ìˆ˜
- create_sliding_windows(): 3D í…ì„œ ìƒì„±
  * ì…ë ¥: (samples, features)
  * ì¶œë ¥: (samples, window_size, features)
- split_windowed_data(): Train/Valid/Test ë¶„í• 
```

### 6. model.py - LSTM ëª¨ë¸
```python
# LSTMModel í´ë˜ìŠ¤
- LSTM ë ˆì´ì–´ (ì–‘ë°©í–¥ ì˜µì…˜)
- ë°°ì¹˜ ì •ê·œí™”
- ë“œë¡­ì•„ì›ƒ
- ì™„ì „ ì—°ê²° ë ˆì´ì–´ (2ì¸µ)
```

### 7. trainer.py - ëª¨ë¸ í•™ìŠµ
```python
# Trainer í´ë˜ìŠ¤
- create_data_loader(): DataLoader ìƒì„±
- train_epoch(): 1 ì—í¬í¬ í•™ìŠµ
- validate(): ê²€ì¦
- fit(): ì „ì²´ í•™ìŠµ (ì¡°ê¸° ì¢…ë£Œ í¬í•¨)
- predict(): ì˜ˆì¸¡
- save_model(): ëª¨ë¸ ì €ì¥
- load_model(): ëª¨ë¸ ë¡œë“œ
```

### 8. evaluator.py - ëª¨ë¸ í‰ê°€
```python
# ì£¼ìš” í•¨ìˆ˜
- compute_metrics(): í‰ê°€ ì§€í‘œ ê³„ì‚° (MSE, RMSE, MAE, R2, MAPE)
- evaluate_model(): ëª¨ë¸ í‰ê°€
- print_metrics(): í‰ê°€ ì§€í‘œ ì¶œë ¥
- save_metrics(): í‰ê°€ ì§€í‘œ ì €ì¥
- save_predictions(): ì˜ˆì¸¡ê°’ ì €ì¥
- plot_training_history(): í•™ìŠµ íˆìŠ¤í† ë¦¬ í”Œë¡¯
- plot_predictions(): ì˜ˆì¸¡ í”Œë¡¯
```

### 9. pipeline.py - ì „ì²´ íŒŒì´í”„ë¼ì¸
```python
# DLPipeline í´ë˜ìŠ¤
- step1_load_data(): ë°ì´í„° ë¡œë“œ
- step2_align_time(): ì‹œê°„ì¶• ì •í•©
- step3_impute_missing(): ê²°ì¸¡ì¹˜ ì²˜ë¦¬
- step4_handle_outliers(): ì´ìƒì¹˜ ì²˜ë¦¬
- step5_resample(): ë¦¬ìƒ˜í”Œë§
- step6_create_features(): íŠ¹ì„± ìƒì„±
- step7_create_windows(): ìŠ¬ë¼ì´ë”© ìœˆë„ìš° ìƒì„±
- step8_scale_data(): ë°ì´í„° ìŠ¤ì¼€ì¼ë§
- step9_train_model(): ëª¨ë¸ í•™ìŠµ
- step10_evaluate(): ëª¨ë¸ í‰ê°€
- step11_save_results(): ê²°ê³¼ ì €ì¥
- run(): ì „ì²´ íŒŒì´í”„ë¼ì¸ ì‹¤í–‰
```

## ì‚¬ìš© ë°©ë²•

### 1. ê¸°ë³¸ ì‹¤í–‰
```bash
python scripts/DL/train_lstm.py
```

### 2. ë¹ ë¥¸ í…ŒìŠ¤íŠ¸
```bash
python scripts/DL/example_usage.py --example 5
```

### 3. ì»¤ìŠ¤í…€ ì„¤ì •
```python
from src.DL.pipeline import DLPipeline
from src.DL.config import get_default_config

config = get_default_config()

# ì„¤ì • ë³€ê²½
config.window.window_size = 12
config.lstm.hidden_size = 128
config.training.num_epochs = 50

# ì‹¤í–‰
pipeline = DLPipeline(config)
pipeline.run(data_dir, target_cols, save_dir)
```

### 4. ë‹¨ê³„ë³„ ì‹¤í–‰
```python
pipeline = DLPipeline(config)

# ì „ì²˜ë¦¬ë§Œ ì‹¤í–‰
pipeline.step1_load_data(data_dir)
pipeline.step2_align_time()
pipeline.step3_impute_missing()
pipeline.step4_handle_outliers()
pipeline.step5_resample()

# ì¤‘ê°„ ë°ì´í„° í™•ì¸
print(pipeline.df_resampled.head())

# ë‚˜ë¨¸ì§€ ì‹¤í–‰
pipeline.step6_create_features(target_cols)
# ...
```

## ì„¤ì • ê°€ì´ë“œ

### ë°ì´í„° ì²˜ë¦¬ ì„¤ì •
```python
DataConfig(
    time_freq="1min",           # ì‹œê°„ ì •í•© ê°„ê²©
    short_term_hours=3,         # ë‹¨ê¸° ê²°ì¸¡ ì„ê³„ê°’
    medium_term_hours=12,       # ì¤‘ê¸° ê²°ì¸¡ ì„ê³„ê°’
    long_term_hours=48,         # ì¥ê¸° ê²°ì¸¡ ì„ê³„ê°’
    ewma_span=6,                # EWMA ìŠ¤íŒ¬
    resample_freq="1h",         # ë¦¬ìƒ˜í”Œë§ ì£¼ê¸°
    resample_agg="mean",        # ë¦¬ìƒ˜í”Œë§ ì§‘ê³„ í•¨ìˆ˜
    outlier_method="iqr",       # ì´ìƒì¹˜ íƒì§€ ë°©ë²•
    iqr_threshold=1.5,          # IQR ë°°ìˆ˜
    zscore_threshold=3.0,       # Z-score ì„ê³„ê°’
    require_both=True           # ë„ë©”ì¸ + í†µê³„ ë‘˜ ë‹¤ ì´ìƒì¹˜ì—¬ì•¼ ì²˜ë¦¬
)
```

### íŠ¹ì„± ìƒì„± ì„¤ì •
```python
FeatureConfig(
    add_time_features=True,     # ì‹œê°„ íŠ¹ì„± ì¶”ê°€
    add_sin_cos=True,           # ì£¼ê¸°ì„± íŠ¹ì„± ì¶”ê°€
    lag_hours=[1, 2, 3, 6, 12, 24],  # Lag ì‹œê°„
    rolling_windows=[3, 6, 12, 24],  # Rolling ìœˆë„ìš°
    rolling_stats=["mean", "std"]    # Rolling í†µê³„ëŸ‰
)
```

### ìŠ¬ë¼ì´ë”© ìœˆë„ìš° ì„¤ì •
```python
WindowConfig(
    window_size=24,  # ê³¼ê±° 24ì‹œê°„ ë°ì´í„° ì‚¬ìš©
    horizon=1,       # 1ì‹œê°„ í›„ ì˜ˆì¸¡
    stride=1         # 1ì‹œê°„ì”© ì´ë™
)
```

### ë°ì´í„° ë¶„í•  ì„¤ì •
```python
SplitConfig(
    train_ratio=0.7,   # í•™ìŠµ 70%
    valid_ratio=0.15,  # ê²€ì¦ 15%
    test_ratio=0.15    # í…ŒìŠ¤íŠ¸ 15%
)
```

### LSTM ëª¨ë¸ ì„¤ì •
```python
LSTMConfig(
    hidden_size=64,      # ì€ë‹‰ì¸µ í¬ê¸°
    num_layers=2,        # LSTM ë ˆì´ì–´ ìˆ˜
    dropout=0.2,         # ë“œë¡­ì•„ì›ƒ ë¹„ìœ¨
    bidirectional=False  # ì–‘ë°©í–¥ LSTM ì‚¬ìš© ì—¬ë¶€
)
```

### í•™ìŠµ ì„¤ì •
```python
TrainingConfig(
    batch_size=32,         # ë°°ì¹˜ í¬ê¸°
    learning_rate=0.001,   # í•™ìŠµë¥ 
    num_epochs=100,        # ìµœëŒ€ ì—í¬í¬
    patience=10,           # ì¡°ê¸° ì¢…ë£Œ patience
    grad_clip=1.0,         # ê·¸ë˜ë””ì–¸íŠ¸ í´ë¦¬í•‘
    weight_decay=0.0001    # L2 ì •ê·œí™”
)
```

## ë¬¸ì œ í•´ê²°

### 1. CUDA ì˜¤ë¥˜
```python
# CPU ì‚¬ìš©ìœ¼ë¡œ ë³€ê²½
config.device = "cpu"
```

### 2. ë©”ëª¨ë¦¬ ë¶€ì¡±
```python
# ë°°ì¹˜ í¬ê¸° ê°ì†Œ
config.training.batch_size = 16

# ìœˆë„ìš° í¬ê¸° ê°ì†Œ
config.window.window_size = 12

# Stride ì¦ê°€
config.window.stride = 2
```

### 3. í•™ìŠµì´ ëŠë¦° ê²½ìš°
```python
# ì—í¬í¬ ìˆ˜ ê°ì†Œ
config.training.num_epochs = 50

# ëª¨ë¸ í¬ê¸° ê°ì†Œ
config.lstm.hidden_size = 32
config.lstm.num_layers = 1
```

### 4. ê³¼ì í•© ë¬¸ì œ
```python
# ë“œë¡­ì•„ì›ƒ ì¦ê°€
config.lstm.dropout = 0.3

# L2 ì •ê·œí™” ì¦ê°€
config.training.weight_decay = 0.001

# ì¡°ê¸° ì¢…ë£Œ patience ê°ì†Œ
config.training.patience = 5
```

### 5. ê³¼ì†Œì í•© ë¬¸ì œ
```python
# ëª¨ë¸ í¬ê¸° ì¦ê°€
config.lstm.hidden_size = 128
config.lstm.num_layers = 3

# í•™ìŠµë¥  ì¡°ì •
config.training.learning_rate = 0.0001

# ì—í¬í¬ ìˆ˜ ì¦ê°€
config.training.num_epochs = 200
```

## ì„±ëŠ¥ ìµœì í™” íŒ

### 1. ë°ì´í„° ì „ì²˜ë¦¬
- ê²°ì¸¡ì¹˜ê°€ ë§ì€ ì»¬ëŸ¼ì€ ì œê±° ê³ ë ¤
- ì´ìƒì¹˜ ì²˜ë¦¬ ì„ê³„ê°’ ì¡°ì •
- ë¦¬ìƒ˜í”Œë§ ì£¼ê¸° ìµœì í™”

### 2. íŠ¹ì„± ì—”ì§€ë‹ˆì–´ë§
- ë„ë©”ì¸ ì§€ì‹ ê¸°ë°˜ íŠ¹ì„± ì¶”ê°€
- ë¶ˆí•„ìš”í•œ íŠ¹ì„± ì œê±°
- íŠ¹ì„± ì„ íƒ (Feature Selection) ì ìš©

### 3. ëª¨ë¸ íŠœë‹
- í•˜ì´í¼íŒŒë¼ë¯¸í„° ê·¸ë¦¬ë“œ ì„œì¹˜
- Learning rate scheduler ì‚¬ìš©
- Batch normalization ì¶”ê°€

### 4. í•™ìŠµ ì „ëµ
- K-Fold Cross Validation
- Ensemble ëª¨ë¸
- Transfer Learning

## ì°¸ê³  ìë£Œ

- [QUICK_START_DL.md](QUICK_START_DL.md) - ë¹ ë¥¸ ì‹œì‘ ê°€ì´ë“œ
- [scripts/DL/README.md](scripts/DL/README.md) - ìŠ¤í¬ë¦½íŠ¸ ìƒì„¸ ì„¤ëª…
- [PyTorch ê³µì‹ ë¬¸ì„œ](https://pytorch.org/docs/stable/index.html)
- [LSTM ë…¼ë¬¸](https://www.bioinf.jku.at/publications/older/2604.pdf)

## ë¬¸ì˜
ë¬¸ì œê°€ ë°œìƒí•˜ê±°ë‚˜ ì§ˆë¬¸ì´ ìˆìœ¼ë©´ ì´ìŠˆë¥¼ ë“±ë¡í•´ì£¼ì„¸ìš”.
